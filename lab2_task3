def get_coordinates(location_of_coutry):
    """
    Function returns coordinates of place, where movies were shot
    >>> get_coordinates('Los Angeles, USA')
    (34.0536909, -118.242766)
    >>> get_coordinates('Lviv, Ukraine')
    (49.841952, 24.0315921)
    """
    geolocator = Nominatim(user_agent="https://www.openstreetmap.org/copyright")
    try:
        location = geolocator.geocode(location_of_coutry)
        if not location:
            return None
    except (AttributeError, GeocoderUnavailable):
        return None
    return location.latitude, location.longitude


def create_map(artist):
    """
    Function for creating map
    """
    token = get_token()
    artist_id = search_for_artist(token, artist)
    song_id = get_song_id_by_artist_id(token, artist_id)[1]
    markets = get_markets(token, song_id)
    map = folium.Map(zoom_start=1)
    html = """
    Country: {} <br>
    """
    figure = folium.FeatureGroup(name='Available markets')
    for i in markets:
        country_coords = get_coordinates(i)
        if not country_coords:
            continue
        country_name = pycountry.countries.get(alpha_2=i)
        if country_name is None:
            continue
        iframe = folium.IFrame(html=html.format(country_name.name),
                            width=80,
                            height=50)
        figure.add_child(folium.Marker(location=[country_coords[0], country_coords[1]],
                popup=folium.Popup(iframe),
                icon=folium.Icon(color = "brown", icon="fa-music", prefix="fa")))
        map.add_child(figure)
    map.add_child(folium.LayerControl())
    return map._repr_html_()

app = Flask(__name__)

@app.route('/', methods=['GET', 'POST'])
def get_artist():
    """
    Function returns name of artist
    """
    if request.method == 'POST':
        name_art = request.form.get('q')
        return redirect(url_for('info', artist=name_art))
    else:
        return render_template('button.html')

@app.route('/<artist>')
def info(artist):
    """
    Function for button
    """
    art = f'{artist}'
    return create_map(art)

if __name__ == '__main__':
    app.run(debug=True)

